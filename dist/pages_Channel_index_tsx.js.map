{"version":3,"file":"pages_Channel_index_tsx.js","mappings":"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","sources":["webpack://slack-clone/./pages/Channel/index.tsx","webpack://slack-clone/./pages/Channel/styles.tsx"],"sourcesContent":["import React, { useCallback, useEffect, useRef, useState } from 'react';\nimport { Container, Header } from '@pages/DirectMessage/styles';\nimport { useParams } from 'react-router';\nimport useSWR, { useSWRInfinite } from 'swr';\nimport fetcher from '@utils/fetcher';\nimport ChatBox from '@components/ChatBox';\nimport ChatList from '@components/ChatList';\nimport useInput from '@hooks/useInput';\nimport axios from 'axios';\nimport { IChannel, IChat, IUser } from '@typings/db';\nimport makeSection from '@utils/makeSection';\nimport Scrollbars from 'react-custom-scrollbars';\nimport useSocket from '@hooks/useSocket';\nimport InviteChannelModal from '@components/InviteChannelModal';\nimport { DragOver } from './styles';\n\nconst Channel = () => {\n  const { workspace, channel } = useParams<{ workspace: string; channel: string }>();\n  const { data: myData } = useSWR('/api/users', fetcher);\n  const [chat, onChangeChat, setChat] = useInput('');\n  const { data: channelData } = useSWR<IChannel>(`/api/workspaces/${workspace}/channels/${channel}`, fetcher);\n  const {\n    data: chatData,\n    mutate: mutateChat,\n    revalidate,\n    setSize,\n  } = useSWRInfinite<IChat[]>(\n    (index) => `/api/workspaces/${workspace}/channels/${channel}/chats?perPage=20&page=${index + 1}`,\n    fetcher,\n  );\n  const { data: channelMembersData } = useSWR<IUser[]>(\n    myData ? `/api/workspaces/${workspace}/channels/${channel}/members` : null,\n    fetcher,\n  );\n  const [socket] = useSocket(workspace);\n  const isEmpty = chatData?.[0]?.length === 0;\n  const isReachingEnd = isEmpty || (chatData && chatData[chatData.length - 1]?.length < 20) || false;\n  const scrollbarRef = useRef<Scrollbars>(null);\n  const [showInviteChannelModal, setShowInviteChannelModal] = useState(false);\n  const [dragOver, setDragOver] = useState(false);\n\n  // 0초 A: 안녕~(optimistic UI)\n  // 1초 B: 안녕~\n  // 2초 A: 안녕~(실제 서버)\n\n  const onSubmitForm = useCallback(\n    (e) => {\n      e.preventDefault();\n      console.log(chat);\n      if (chat?.trim() && chatData && channelData) {\n        const savedChat = chat;\n        mutateChat((prevChatData) => {\n          prevChatData?.[0].unshift({\n            id: (chatData[0][0]?.id || 0) + 1,\n            content: savedChat,\n            UserId: myData.id,\n            User: myData,\n            ChannelId: channelData.id,\n            Channel: channelData,\n            createdAt: new Date(),\n          });\n          return prevChatData;\n        }, false).then(() => {\n          setChat('');\n          scrollbarRef.current?.scrollToBottom();\n        });\n        axios\n          .post(`/api/workspaces/${workspace}/channels/${channel}/chats`, {\n            content: chat,\n          })\n          .then(() => {\n            revalidate();\n          })\n          .catch(console.error);\n      }\n    },\n    [chat, chatData, myData, channelData, workspace, channel],\n  );\n\n  const onMessage = useCallback(\n    (data: IChat) => {\n      // id는 상대방 아이디\n      if (\n        data.Channel.name === channel &&\n        (data.content.startsWith('uploads\\\\') || data.content.startsWith('uploads/') || data.UserId !== myData?.id)\n      ) {\n        mutateChat((chatData) => {\n          chatData?.[0].unshift(data);\n          return chatData;\n        }, false).then(() => {\n          if (scrollbarRef.current) {\n            if (\n              scrollbarRef.current.getScrollHeight() <\n              scrollbarRef.current.getClientHeight() + scrollbarRef.current.getScrollTop() + 150\n            ) {\n              console.log('scrollToBottom!', scrollbarRef.current?.getValues());\n              setTimeout(() => {\n                scrollbarRef.current?.scrollToBottom();\n              }, 50);\n            }\n          }\n        });\n      }\n    },\n    [channel, myData],\n  );\n\n  useEffect(() => {\n    socket?.on('message', onMessage);\n    return () => {\n      socket?.off('message', onMessage);\n    };\n  }, [socket, onMessage]);\n\n  // 로딩 시 스크롤바 제일 아래로\n  useEffect(() => {\n    if (chatData?.length === 1) {\n      console.log('toBottomWhenLoaded', scrollbarRef.current);\n      setTimeout(() => {\n        console.log('scrollbar', scrollbarRef.current);\n        scrollbarRef.current?.scrollToBottom();\n      }, 500);\n    }\n  }, [chatData]);\n\n  const onClickInviteChannel = useCallback(() => {\n    setShowInviteChannelModal(true);\n  }, []);\n\n  const onCloseModal = useCallback(() => {\n    setShowInviteChannelModal(false);\n  }, []);\n\n  const onChangeFile = useCallback((e) => {\n    const formData = new FormData();\n    if (e.target.files) {\n      // Use DataTransferItemList interface to access the file(s)\n      for (let i = 0; i < e.target.files.length; i++) {\n        const file = e.target.files[i].getAsFile();\n        console.log('... file[' + i + '].name = ' + file.name);\n        formData.append('image', file);\n      }\n    }\n    axios.post(`/api/workspaces/${workspace}/channels/${channel}/images`, formData).then(() => {});\n  }, []);\n\n  useEffect(() => {\n    localStorage.setItem(`${workspace}-${channel}`, new Date().getTime().toString());\n  }, [workspace, channel]);\n\n  const onDrop = useCallback(\n    (e) => {\n      e.preventDefault();\n      console.log(e);\n      const formData = new FormData();\n      if (e.dataTransfer.items) {\n        // Use DataTransferItemList interface to access the file(s)\n        for (let i = 0; i < e.dataTransfer.items.length; i++) {\n          // If dropped items aren't files, reject them\n          console.log(e.dataTransfer.items[i]);\n          if (e.dataTransfer.items[i].kind === 'file') {\n            const file = e.dataTransfer.items[i].getAsFile();\n            console.log(e, '.... file[' + i + '].name = ' + file.name);\n            formData.append('image', file);\n          }\n        }\n      } else {\n        // Use DataTransfer interface to access the file(s)\n        for (let i = 0; i < e.dataTransfer.files.length; i++) {\n          console.log(e, '... file[' + i + '].name = ' + e.dataTransfer.files[i].name);\n          formData.append('image', e.dataTransfer.files[i]);\n        }\n      }\n      axios.post(`/api/workspaces/${workspace}/channels/${channel}/images`, formData).then(() => {\n        setDragOver(false);\n        localStorage.setItem(`${workspace}-${channel}`, new Date().getTime().toString());\n      });\n    },\n    [workspace, channel],\n  );\n\n  const onDragOver = useCallback((e) => {\n    e.preventDefault();\n    console.log(e);\n    setDragOver(true);\n  }, []);\n\n  // if (channelsData && !channelData) {\n  //   return <Redirect to={`/workspace/${workspace}/channel/일반`} />;\n  // }\n\n  if (!myData || !myData) {\n    return null;\n  }\n\n  const chatSections = makeSection(chatData ? chatData.flat().reverse() : []);\n\n  return (\n    <Container onDrop={onDrop} onDragOver={onDragOver}>\n      <Header>\n        <span>#{channel}</span>\n        <div style={{ display: 'flex', flex: 1, justifyContent: 'flex-end', alignItems: 'center' }}>\n          <span>{channelMembersData?.length}</span>\n          <button\n            onClick={onClickInviteChannel}\n            className=\"c-button-unstyled p-ia__view_header__button\"\n            aria-label=\"Add people to #react-native\"\n            data-sk=\"tooltip_parent\"\n            type=\"button\"\n          >\n            <i className=\"c-icon p-ia__view_header__button_icon c-icon--add-user\" aria-hidden=\"true\" />\n          </button>\n        </div>\n      </Header>\n      <ChatList chatSections={chatSections} ref={scrollbarRef} setSize={setSize} isReachingEnd={isReachingEnd} />\n      <ChatBox chat={chat} onChangeChat={onChangeChat} onSubmitForm={onSubmitForm} />\n      <InviteChannelModal\n        show={showInviteChannelModal}\n        onCloseModal={onCloseModal}\n        setShowInviteChannelModal={setShowInviteChannelModal}\n      />\n      {dragOver && <DragOver>업로드!</DragOver>}\n    </Container>\n  );\n};\n\nexport default Channel;\n","import styled from '@emotion/styled';\n\nexport const Container = styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  height: calc(100vh - 38px);\n  flex-flow: column;\n  position: relative;\n`;\n\nexport const Header = styled.header`\n  height: 64px;\n  display: flex;\n  width: 100%;\n  --saf-0: rgba(var(--sk_foreground_low, 29, 28, 29), 0.13);\n  box-shadow: 0 1px 0 var(--saf-0);\n  padding: 20px 16px 20px 20px;\n  font-weight: bold;\n  align-items: center;\n  \n  & .header-right {\n    display: flex;\n    flex: 1;\n    justify-content: flex-end;\n    align-items: center;\n`;\n\nexport const DragOver = styled.div`\n  position: absolute;\n  top: 64px;\n  left: 0;\n  width: 100%;\n  height: calc(100% - 64px);\n  background: white;\n  opacity: 0.7;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 40px;\n`;\n"],"names":["React","useCallback","useEffect","useRef","useState","Container","Header","useParams","useSWR","useSWRInfinite","fetcher","ChatBox","ChatList","useInput","axios","makeSection","useSocket","InviteChannelModal","DragOver","Channel","workspace","channel","myData","data","chat","onChangeChat","setChat","channelData","index","chatData","mutateChat","mutate","revalidate","setSize","channelMembersData","socket","isEmpty","length","isReachingEnd","scrollbarRef","showInviteChannelModal","setShowInviteChannelModal","dragOver","setDragOver","onSubmitForm","e","preventDefault","console","log","trim","savedChat","prevChatData","unshift","id","content","UserId","User","ChannelId","createdAt","Date","then","current","scrollToBottom","post","catch","error","onMessage","name","startsWith","getScrollHeight","getClientHeight","getScrollTop","getValues","setTimeout","on","off","onClickInviteChannel","onCloseModal","onChangeFile","formData","FormData","target","files","i","file","getAsFile","append","localStorage","setItem","getTime","toString","onDrop","dataTransfer","items","kind","onDragOver","chatSections","flat","reverse","display","flex","justifyContent","alignItems"],"sourceRoot":""}